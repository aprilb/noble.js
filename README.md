# noble.js

NobleHour API Client library for browser-based applications. Distrubuted as a
[Component.js](https://github.com/component/component) component.

## Installation

    $ component install treetopllc/noble.js

## Documentation

This is a general client-side JavaScript API, in the future we will be releasing
this as a Node/NPM module as well.

All instances in the documentation below of a `callback` parameter will be given
the following arguments, unless otherwise specified:

| Parameter | Type                  | Description                           |
| --------- | --------------------- | ------------------------------------- |
| `err`     | `Error`               | The API error (if applicable)         |
| `data`    | `Object`              | The parsed API result (if applicable) |
| `res`     | `SuperAgent.Response` | The response object generated by [SuperAgent](http://visionmedia.github.io/superagent/) |


### Client(url, id, secret) *constructor*

Builds a new instance of the API client for a given url/id/secret combination.

**Returns**: `Client` object instance

| Parameter | Type     | Description   |
| --------- | -------- | ------------- |
| `url`     | `String` | API Base URL  |
| `id`      | `String` | Client ID     |
| `secret`  | `String` | Client Secret |


### Client#url(path)

Constructs a URL for an API call using the configured base URL. This is largely
an internal function.

**Returns**: `String`

| Parameter | Type     | Description               |
| --------- | -------- | ------------------------- |
| `path`    | `String` | Path to some API resource |


### Client#request([method], uri)

Creates a SuperAgent Request object and returns it so it can be further
configured before making the actual request. This is also a largely internal
function.

**Returns**: `SuperAgent.Request` object instance

| Parameter | Type     | Default | Description                        |
| --------- | -------- | ------- | ---------------------------------- |
| `method`  | `String` | `"GET"` | An HTTP verb (`GET`, `POST`, etc.) |
| `uri`     | `String` | `""`    | Will be passed to `Client#url()`   |


### Client#index(callback)

Queries the NobleHour API root, which includes version information.

| Parameter  | Type       | Description |
| ---------- | ---------- | ----------- |
| `callback` | `Function` | *See above* |


### Client#login(username, password, callback)

Performs an API login, which is required for most API calls. Credentials
reflect a NobleHour account only.

| Parameter  | Type       | Description                |
| ---------- | ---------- | -------------------------- |
| `username` | `String`   | NobleHour account username |
| `password` | `String`   | NobleHour account password |
| `callback` | `Function` | *See above*                |


### Client#search(params, callback)

Performs a search via treetopllc/drake, which uses many possible criteria,
including graph traversal, location and full-text indexing.

| Parameter  | Type       | Description                   |
| ---------- | ---------- | ----------------------------- |
| `params`   | `Object`   | *See available options below* |
| `callback` | `Function` | *See above*                   |

**Available Options (params)**

| Parameter | Type      | Default | Description                                         |
| --------- | --------- | ------- | --------------------------------------------------- |
| `geojson` | `Boolean` | `false` | Whether to retrieve data as GeoJSON                 |
| `types`   | `Array`   | `null`  | Entity types (as `String` or `Number`)              |
| `terms`   | `String`  | `""`    | Full-text search terms (e.g. "keywords")            |
| `lat`     | `Number`  | `null`  | Latitude coordinate                                 |
| `lon`     | `Number`  | `null`  | Longitude coordinate                                |
| `limit`   | `Number`  | `null`  | Limit result size (API currently defaults to `200`) |

**Special Instructions for the `types` Parameter**

The `types` parameter is an array of entity types, you can either use a `String`
value (not case-sensitive) or the corresponding `Number` value, here's a table
for reference:

| ID   | Name                  |
| :--: | --------------------- |
| 0    | News                  |
| 1    | Groups                |
| 2    | Organizations         |
| 3    | Opportunities         |
| 4    | Offline Organizations |
| 5    | Events                |
| 6    | Customers             |
| 7    | Users                 |
| 8    | Resources             |

For example, on the Explore interface, we use: `[ 2, 3, 5 ]`, which is the
same as: `[ "organizations", "opportunities", "events" ]`


### Client#mailboxes(callback)

Retrieves a list of available mailboxes from the API.

| Parameter  | Type       | Description |
| ---------- | ---------- | ----------- |
| `callback` | `Function` | *See above* |


### Client#mailbox(id)

Return an object representing a `User`. (Inherits from `Vertex`)

| Parameter | Type     | Description                        |
| --------- | -------- | ---------------------------------- |
| `id`      | `String` | Mailbox ID (most likely a user ID) |


### Mailbox(client, id) *constructor*

Represents a mailbox within the Alerts API.

| Parameter | Type     | Description                                |
| --------- | -------- | ------------------------------------------ |
| `client`  | `Client` | The base client object (passed internally) |
| `id`      | `String` | Mailbox ID (most likely a user ID)         |


### Mailbox#get(query, callback)

Returns the mailbox contents.

| Parameter  | Type       | Description                       |
| ---------- | ---------- | --------------------------------- |
| `query`    | `Object`   | Additional query-string arguments |
| `callback` | `Function` | *See above*                       |


### Mailbox#create(attr, pref, callback)

Creates a new mailbox with the given configuration.

**TODO**: Get PonyExpress documented so we can simply link to that.

| Parameter  | Type       | Description |
| ---------- | ---------- | ----------- |
| `attr`     | `Object`   | Attributes  |
| `pref`     | `Object`   | Preferences |
| `callback` | `Function` | *See above* |


### Mailbox#stats(callback)

Returns the statistics for this mailbox:

 * **new**: Number of Unread Alerts
 * **deleted**: Number of Deleted Alerts
 * **read**: Number of Read Alerts
 * **total**: Total Number of Alerts

| Parameter  | Type       | Description                       |
| ---------- | ---------- | --------------------------------- |
| `callback` | `Function` | *See above*                       |


### Mailbox#markUnread(alerts, callback)

Mark the specified alerts as unread.

| Parameter  | Type       | Description        |
| ---------- | ---------- | ------------------ |
| `alerts`   | `String`   | Array of Alert IDs |
| `callback` | `Function` | *See above*        |


### Mailbox#markRead(alerts, callback)

Mark the specified alerts as read.

| Parameter  | Type       | Description        |
| ---------- | ---------- | ------------------ |
| `alerts`   | `String`   | Array of Alert IDs |
| `callback` | `Function` | *See above*        |


### Vertex(client, id) *constructor*

Represents a generic vertex within the graph.

| Parameter | Type     | Description                                |
| --------- | -------- | ------------------------------------------ |
| `client`  | `Client` | The base client object (passed internally) |
| `id`      | `String` | User UUID                                  |


### Vertex#get(callback)

Returns the vertex information.

| Parameter  | Type       | Description |
| ---------- | ---------- | ----------- |
| `callback` | `Function` | *See above* |


### Vertex#related(type, query, callback)

Returns a list of vertices that are related via the `type` parameter.

| Parameter  | Type       | Description             |
| ---------- | ---------- | ----------------------- |
| `type`     | `String`   | Varies by vertex type   |
| `query`    | `Object`   | Query-string parameters |
| `callback` | `Function` | *See above*             |


### Client#user(id)

Returns a `User` object.

| Parameter | Type     | Description |
| --------- | -------- | ----------- |
| `id`      | `String` | User UUID   |


### User(client, id) *constructor*

Represents a User within the Graph API. (inherits from `Vertex`)

| Parameter | Type     | Description                                |
| --------- | -------- | ------------------------------------------ |
| `client`  | `Client` | The base client object (passed internally) |
| `id`      | `String` | User / Vertex ID                           |


### User#submissions(query, callback)

Retrieves a list of submissions for this user.

| Parameter  | Type       | Description             |
| ---------- | ---------- | ----------------------- |
| `query`    | `Object`   | Query-string parameters |
| `callback` | `Function` | *See above*             |


### Client#submission(id)

Returns a `Submission` object.

| Parameter | Type     | Description |
| --------- | -------- | ----------- |
| `id`      | `String` | User UUID   |


### Submission(client, id) *constructor*

Represents a Submission within the Graph API. (inherits from `Vertex`)

| Parameter | Type     | Description                                |
| --------- | -------- | ------------------------------------------ |
| `client`  | `Client` | The base client object (passed internally) |
| `id`      | `String` | Submission / Vertex ID                     |


### Submission#status(contentId, typeId, status, description, callback)

Updates the status of a submission. Available status codes:

|  ID  | Description |
| :--: | ----------- |
|  0   | Unsubmitted |
|  1   | Accepted    |
|  2   | Denied      |
|  3   | Pending     |

| Parameter     | Type       | Description                                                       |
| ------------- | ---------- | ----------------------------------------------------------------- |
| `contentId`   | `String`   | Required to identify the submission (`vertex.content_id`)         |
| `typeId`      | `Number`   | Required to identify the submission (`vertex.submission_type_id`) |
| `status`      | `Number`   | *See above for available status codes*                            |
| `description` | `String`   | **Optional** description (saved for historical purposes)          |
| `callback`    | `Function` | *See above*                                                       |


### Submission#accept(contentId, typeId, description, callback)

Short-hand for setting the status to `1`.

| Parameter     | Type       | Description                                                       |
| ------------- | ---------- | ----------------------------------------------------------------- |
| `contentId`   | `String`   | Required to identify the submission (`vertex.content_id`)         |
| `typeId`      | `Number`   | Required to identify the submission (`vertex.submission_type_id`) |
| `description` | `String`   | **Optional** description (saved for historical purposes)          |
| `callback`    | `Function` | *See above*                                                       |


### Submission#deny(contentId, typeId, description, callback)

Short-hand for setting the status to `2`.

| Parameter     | Type       | Description                                                       |
| ------------- | ---------- | ----------------------------------------------------------------- |
| `contentId`   | `String`   | Required to identify the submission (`vertex.content_id`)         |
| `typeId`      | `Number`   | Required to identify the submission (`vertex.submission_type_id`) |
| `description` | `String`   | **Optional** description (saved for historical purposes)          |
| `callback`    | `Function` | *See above*                                                       |
